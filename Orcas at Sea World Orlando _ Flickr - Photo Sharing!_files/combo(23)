YUI.add("hermes-template-mobile-photo-engagement",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return" small-text"}function h(e,t){return" super-small-text"}function p(e,t){var r="",i,s,o;r+='\n		<span class="fave-count-label">\n			',s=n["if"].call(e,(i=e.engagement,i==null||i===!1?i:i.isFaved),{hash:{},inverse:a.program(8,v,t),fn:a.program(6,d,t),data:t});if(s||s===0)r+=s;return r+="\n			",o={hash:{},data:t},r+=l((i=n.friendlyNumber||e.friendlyNumber,i?i.call(e,(i=e.engagement,i==null||i===!1?i:i.faveCount),o):f.call(e,"friendlyNumber",(i=e.engagement,i==null||i===!1?i:i.faveCount),o)))+"\n		</span>\n	",r}function d(e,t){return'\n				<svg class="icon icon-fave"><use xlink:href="#icon-fave"></use></svg>\n			'}function v(e,t){return'\n				<svg class="icon icon-fave_hollow"><use xlink:href="#icon-fave_hollow"></use></svg>\n			'}function m(e,t){return'\n		<span class="fave-count-label">\n			<svg class="icon icon-fave_hollow"><use xlink:href="#icon-fave_hollow"></use></svg>\n			0\n		</span>\n	'}function g(e,t){var r="",i,s;return r+='\n		<span class="comment-count-label">\n			<svg class="icon icon-comment_hollow"><use xlink:href="#icon-comment_hollow"></use></svg>\n			',s={hash:{},data:t},r+=l((i=n.friendlyNumber||e.friendlyNumber,i?i.call(e,(i=e.engagement,i==null||i===!1?i:i.commentCount),s):f.call(e,"friendlyNumber",(i=e.engagement,i==null||i===!1?i:i.commentCount),s)))+"\n		</span>\n	",r}function y(e,t){return'\n		<span class="comment-count-label">\n			<svg class="icon icon-comment_hollow"><use xlink:href="#icon-comment_hollow"></use></svg>\n		0</span>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=this,f=n.helperMissing,l=this.escapeExpression;s+='<div class="fave-count',o=n["if"].call(t,t.smallText,{hash:{},inverse:a.noop,fn:a.program(1,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.superSmallText,{hash:{},inverse:a.noop,fn:a.program(3,h,i),data:i});if(o||o===0)s+=o;s+='">\n	',u=n["if"].call(t,(o=t.engagement,o==null||o===!1?o:o.faveCount),{hash:{},inverse:a.program(10,m,i),fn:a.program(5,p,i),data:i});if(u||u===0)s+=u;s+='\n</div>\n\n<div class="comment-count',u=n["if"].call(t,t.smallText,{hash:{},inverse:a.noop,fn:a.program(1,c,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,t.superSmallText,{hash:{},inverse:a.noop,fn:a.program(3,h,i),data:i});if(u||u===0)s+=u;s+='">\n	',u=n["if"].call(t,(o=t.engagement,o==null||o===!1?o:o.commentCount),{hash:{},inverse:a.program(14,y,i),fn:a.program(12,g,i),data:i});if(u||u===0)s+=u;return s+='\n</div>\n\n<div class="share-container">\n	<span class="share-container-icon">\n		<svg class="icon icon-share_hollow"><use xlink:href="#icon-share_hollow"></use></svg>\n	</span>\n</div>\n\n<div class="infos-container">\n	<span class="infos-label">\n		<svg class="icon icon-info_hollow"><use xlink:href="#icon-info_hollow"></use></svg>\n	</span>\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-photo-engagement",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-mobile-share-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<form>\n	<input class="share" type="text" value="',(o=n.shortUrl)?o=o.call(t,{hash:{},data:i}):(o=t.shortUrl,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\n</form>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-share-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-mobile-infos-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s;return r+='\n    <i class="ui-icon-tiny-',(i=n.license)?i=i.call(e,{hash:{},data:t}):(i=e.license,i=typeof i===u?i.apply(e):i),r+=a(i)+'cc"></i> ',s={hash:{intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n",r}function h(e,t){var r="",i,s;return r+='\n    <i class="ui-icon-tiny-government"></i> ',s={hash:{intlName:"photo-page-scrappy.USA_GOV_WORK"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n",r}function p(e,t){var r="",i,s;return r+='\n    <i class="ui-icon-tiny-noKnown"></i> ',s={hash:{intlName:"photo-page-scrappy.NO_RESTRICTIONS"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n",r}function d(e,t){var r="",i,s;return r+='\n    <i class="ui-icon-tiny-copyright"></i> ',s={hash:{intlName:"photo-page-scrappy.ALL_RIGHTS_RESERVED"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n",r}function v(e,t){var r="",i,s;return r+='\n    <i class="ui-icon-tiny-10cc"></i>  ',s={hash:{intlName:"photo-page-scrappy.PUBLIC_DOMAIN"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n",r}function m(e,t){var r="",i,s;return r+="\n	",s={hash:{intlName:"info-charm.PRIVATE_PHOTO"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n",r}function g(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.isPublic,{hash:{},inverse:l.program(16,b,t),fn:l.program(14,y,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function y(e,t){var r="",i,s;return r+="\n		",s={hash:{intlName:"info-charm.PUBLIC_PHOTO"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n	",r}function b(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.isVisibleByFriendsAndFamily,{hash:{},inverse:l.program(19,E,t),fn:l.program(17,w,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function w(e,t){var r="",i,s;return r+="\n			",s={hash:{intlName:"info-charm.FRIENDS_AND_FAMILY_PHOTO"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n		",r}function E(e,t){var r="",i;r+="\n			",i=n["if"].call(e,e.isVisibleByFriends,{hash:{},inverse:l.noop,fn:l.program(20,S,t),data:t});if(i||i===0)r+=i;r+="\n\n			",i=n["if"].call(e,e.isVisibleByFamily,{hash:{},inverse:l.noop,fn:l.program(22,x,t),data:t});if(i||i===0)r+=i;return r+="\n\n		",r}function S(e,t){var r="",i,s;return r+="\n				",s={hash:{intlName:"info-charm.FRIENDS_PHOTO"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n			",r}function x(e,t){var r="",i,s;return r+="\n				",s={hash:{intlName:"info-charm.FAMILY_PHOTO"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=n.helperMissing,l=this;s+="<p>\n",o=n["if"].call(t,t.licenseIsCreativeCommons,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;s+="\n",o=n["if"].call(t,t.licenseisGovt,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;s+="\n",o=n["if"].call(t,t.licenseisNoLic,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;s+="\n",o=n["if"].call(t,t.licenseisCopy,{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(o||o===0)s+=o;s+="\n",o=n["if"].call(t,t.licenseIsPDW,{hash:{},inverse:l.noop,fn:l.program(9,v,i),data:i});if(o||o===0)s+=o;s+="\n</p>\n\n<p>\n",o=n["if"].call(t,t.isPrivate,{hash:{},inverse:l.program(13,g,i),fn:l.program(11,m,i),data:i});if(o||o===0)s+=o;return s+="\n</p>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-infos-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("privacy-helper",function(e){function t(e){var t,n,r,i,s;return t={isPublic:!1,isVisibleByFriends:!1,isVisibleByFamily:!1},n={isPublic:!0,isVisibleByFriends:!1,isVisibleByFamily:!1},r={isPublic:!1,isVisibleByFriends:!0,isVisibleByFamily:!1},i={isPublic:!1,isVisibleByFriends:!1,isVisibleByFamily:!0},s={isPublic:!1,isVisibleByFriends:!0,isVisibleByFamily:!0},typeof e=="object"?e.isPublic?"public":e.isVisibleByFriends&&e.isVisibleByFamily?"friendsandfamily":e.isVisibleByFamily?"family":e.isVisibleByFriends?"friends":"private":e==="public"?n:e==="friendsandfamily"?s:e==="friends"?r:e==="family"?i:t}e.PrivacyHelper={mapPrivacy:t}},"@VERSION@",{requires:[]});
YUI.add("mobile-photo-engagement-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.isOwner=e.isOwner,this.nsid=e.nsid,this},loadState:function(){var t=this,n={};return n.photoEngagement=this.appContext.getModel("photo-engagement-models",this.photoId),n.photo=this.appContext.getModel("photo-models",this.photoId),n.privacy=this.appContext.getModel("photo-privacy-models",this.photoId),this.isOwner&&(n.personModel=this.appContext.getModel("person-models",this.nsid)),(new e.FlickrPromise(n)).then(function(e){t.set("photo-engagement",e.photoEngagement),t.set("photo",e.photo),t.set("privacy",e.privacy)},function(t){e.Flog.error("[sub-photo-right-stats-view] Error loadState: ",t)})},buildContainer:function(){var e=this.get("photo-engagement"),t,n,r,i=!1;if(e.getValue("viewCount")>=1e6||e.getValue("faveCount")>=1e5||e.getValue("commentCount")>=1e5)r=!0;else if(e.getValue("viewCount")>=1e5||e.getValue("faveCount")>=1e4||e.getValue("commentCount")>=1e4)n=!0;return this.isOwner&&this.appContext.flipper.isFlipped("rebootify-stats")&&this.isPro&&this.dailyViewsModel.getValue("totals").views>0&&(i=!0),t=this.templates("mobile-photo-engagement")({engagement:e.toJSON(),isMobileStats:this.isMobileStats,smallText:n,superSmallText:r,showMoreStatsLink:i}),this.setContainerHTML(t),this},activate:function(){var t=this.get("photo-engagement"),n=this;return this.registerEventHandler(this.get("container").one(".fave-count").on("click",this.onFaveClick,this)),this.registerEventHandler(this.get("container").one(".share-container").on("click",this.onShareClick,this)),this.registerEventHandler(this.get("container").one(".infos-container").on("click",this.onInfosClick,this)),t&&this.registerEventHandler(t.on("valuesChanged",function(r){var i,s=typeof r.faveCount!="undefined"||typeof r.isFaved!="undefined"||typeof r.canFave!="undefined";if(!s)return;n.processingFave=!0,n.buildContainer(),i=t.remoteUpdate(),i.then(function(){n.processingFave=!1,n.registerEventHandler(n.get("container").one(".fave-count").on("click",n.faveStarClicked,n))},function(i){if(i.code!==3){i.code!==5&&e.Object.each(r,function(e,n){t.setValue(n,e.prevVal)});var s=e.Views.dialog.getInstance("dialog-alert",{content:n.intlMessage({intlName:"fave-view.COULDNT_FAVE"}),attrs:{title:n.intlMessage({intlName:"common.ERROR"}),level:"warning",confirmLabel:n.intlMessage({intlName:"common.OK"})},appContext:n.appContext,dialogClass:"scrappy-dialog"});s.show()}n.processingFave=!1}).then(null,function(e){n.processingFave=!1})},n.photoId)),this},onFaveClick:function(t,n){var r=this,i=this.get("photo-engagement"),s;t.preventDefault();if(this.processingFave)return;this.processingFave=!0,this.bringIntoFocus();if(!this.appContext.getViewer().signedIn){if(this.offNetworkFave){e.SigninHelper.addPendingFave({id:this.photoId},{withPopup:!0,closeWhenDone:!0}),this.processingFave=!1;return}s=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),htmlMessage:this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_MESSAGE"}),actionButtonLabel:this.intlMessage({intlName:"fave-view.SIGN_IN_AND_FAVE"}),cancelButtonLabel:this.intlMessage({intlName:"common.CANCEL"})}),s.on("actionClick",function(){e.SigninHelper.addPendingFave({id:r.photoId})}),s.show(),this.processingFave=!1}else i.getValue("canFave")&&(i.registry.toggleFave(this.photoId),e.rapidTracker.beacon(this.name,"faveStarActionBarButtonClick"))},onInfosClick:function(){var t=parseInt(this.get("photo").getValue("license"),10),n=this.get("privacy"),r=new e.Views.FluidModal({appContext:this.appContext,classList:["infos"],buttons:!1,showCancelButton:!1,htmlMessage:this.templates("mobile-infos-modal")({license:t,licenseIsCreativeCommons:t!==0&&t!==7&&t!==8&&t!==10,licenseisGovt:t===8,licenseisNoLic:t===7,licenseisCopy:t===0,licenseIsCC0:t===9,licenseIsPDW:t===10,isPublic:n.getValue("isPublic")===!0,isVisibleByFamily:n.getValue("isVisibleByFamily")===!0,isVisibleByFriends:n.getValue("isVisibleByFriends")===!0,isVisibleByFriendsAndFamily:n.getValue("isVisibleByFriends")===!0&&n.getValue("isVisibleByFamily")===!0,isPrivate:n.getValue("isPublic")===!1&&n.getValue("isVisibleByFriends")===!1&&n.getValue("isVisibleByFamily")===!1})});r.show()},onShareClick:function(){var t=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"share-modal.SHARE"}),classList:["share"],showActionButton:!0,showCancelButton:!1,htmlMessage:this.templates("mobile-share-modal")({shortUrl:e.URLHelper.getShortURL(this.photoId)})});t.show(),setTimeout(function(){var e=t.get("container").one("input");e&&e._node.setSelectionRange(0,9999)},2e3)}})},"@VERSION@",{requires:["flickr-view","flickrui-css","hermes-template-mobile-photo-engagement","hermes-template-mobile-share-modal","hermes-template-mobile-infos-modal","photo-sidebar-actions-css","fluid-modal-view","stats-photo-view","stats-helper","privacy-helper","url-helper"],optional:["photo-engagement-models"],langBundles:["common","photo-page-scrappy","fave-view","settings","info-charm","share-modal"]});
YUI.add("hermes-lang-settings",function(e,t){e.Intl.add("hermes/settings","en-US",{SAFE:["Safe"],MODERATE:["Moderate"],RESTRICTED:["Restricted"],PUBLIC:["Public"],PRIVATE:["Private"],FRIENDS:["Friends"],FAMILY:["Family"],FRIENDS_AND_FAMILY:["Friends & Family"],ONLY_YOU:["Only you"],PEOPLE_YOU_FOLLOW:["People you follow"],ANY_FLICKR_MEMBER:["Any Flickr member"],SOME_RIGHTS_RESERVED:["Some rights reserved"],ALL_RIGHTS_RESERVED:["All rights reserved"],ATTRIBUTION:["Attribution"],ATTRIBUTION_SHAREALIKE:["Attribution-ShareAlike"],ATTRIBUTION_NODERIVS:["Attribution-NoDerivs"],ATTRIBUTION_NONCOMMERCIAL:["Attribution-NonCommercial"],ATTRIBUTION_NONCOMMERCIAL_SHAREALIKE:["Attribution-NonCommercial-ShareAlike"],ATTRIBUTION_NONCOMMERCIAL_NODERIVS:["Attribution-NonCommercial-NoDerivs"],NO_COPYRIGHT_RESTRICTIONS:["No known copyright restrictions"],US_GOV_WORK:["United States government work"],PUBLIC_DOMAIN_DEDICATION:["Public Domain Dedication (CC0)"],PUBLIC_DOMAIN_WORK:["Public Domain Work"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-info-charm",function(e,t){e.Intl.add("hermes/info-charm","en-US",{CHANGE_PRIVACY_ERROR:["There was a problem changing your photo's privacy"],CHANGE_LICENSE_ERROR:["There was a problem changing your photo's license"],CHANGE_SAFETLY_ERROR:["There was a problem changing your photo's safety level"],PUBLIC_PHOTO:["This photo is public"],FRIENDS_AND_FAMILY_PHOTO:["This photo is visible by friends and family"],FRIENDS_PHOTO:["This photo is visible by friends"],FAMILY_PHOTO:["This photo is visible by family"],PRIVATE_PHOTO:["This photo is private"],PUBLIC:["Public"],"FRIENDS AND FAMILY":["Friends & Family"],FAMILY:["Family"],FRIENDS:["Friends"],PRIVATE:["Private"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-mobile-app-upsell",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){return"is-android"}function c(e,t){return"http://play.google.com/store/apps/details?id=com.yahoo.mobile.client.android.flickr"}function h(e,t){return"http://appstore.com/flickr"}function p(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_ANDROID"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function d(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_IOS"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function v(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_ANDROID_FREE"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function m(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.APP_IOS_FREE"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function g(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.INSTALL"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}function y(e,t){var r="",i,s;return r+="\n					",s={hash:{intlName:"mobile.GET"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n				",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f=this;s+='<div id="smartbanner" class="ios">\n	<!-- <button class="sb-close close-banner"></button> -->\n	<div class="sb-container">\n		<span class="sb-icon">\n			<svg class="close-banner icon icon-close"><use xlink:href="#icon-close"></use></svg>\n		</span>\n		<span class="sb-flickr-icon">\n			<div class="outer-logo ',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='">\n				<div class="ball blue-ball"></div>\n				<div class="ball pink-ball"></div>\n			</div>\n		</span>\n		<div class="sb-info">\n			<a class="sb-button" href="',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.isIOS,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+='">\n				<strong>\n				',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+="\n				",o=n["if"].call(t,t.isIOS,{hash:{},inverse:f.noop,fn:f.program(9,d,i),data:i});if(o||o===0)s+=o;s+="\n				</strong>\n				<span>\n				",o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.program(13,m,i),fn:f.program(11,v,i),data:i});if(o||o===0)s+=o;s+='\n				</span>\n			</a>\n		</div>\n		<div class="sb-view get-app">\n			<span>\n				',o=n["if"].call(t,t.isAndroid,{hash:{},inverse:f.noop,fn:f.program(15,g,i),data:i});if(o||o===0)s+=o;s+="\n				",o=n["if"].call(t,t.isIOS,{hash:{},inverse:f.noop,fn:f.program(17,y,i),data:i});if(o||o===0)s+=o;return s+="\n			</span>\n		</div>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-app-upsell",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("mobile-app-upsell-view",function(e){var t="flickr://",n="https://m.flickr.com/deep/";e.namespace("Views")[this.name]=e.Base.create("mobile-app-upsell-view",e.FlickrView,[],{langBundles:["common","mobile"],initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.buildContainer(),this},buildContainer:function(){var e=this.appContext.getUA().os;return this.setContainerHTML(this.templates("mobile-app-upsell")({isAndroid:e==="android",isIOS:e==="ios"})),this},activate:function(){var e=this.get("container"),t=e.one(".close-banner"),n=e.one(".get-app"),r=this;return t&&this.registerEventHandler(r.addBannerEvent(t,"dism",r.dismissBanner.bind(r))),n&&this.registerEventHandler(r.addBannerEvent(n,"inst",r.installApp.bind(r))),this},addBannerEvent:function(e,t,n){var r=this;return e.on("click",function(e){e.preventDefault(),r.appContext.setCookie({cookieName:t,path:"/",cookieValue:!0,remove:!0}),r.fire("subviewViewEvent","dismissBanner"),n()})},dismissBanner:function(){if(navigator.cookieEnabled){e.rapidTracker.beacon(this.name,"cookies_off",{section:"app-interstitial"});return}var t=parseInt(this.appContext.getCookie("flaidisn"),10);!t||isNaN(t)?t=0:t+=1,e.rapidTracker.beacon(this.name,"app_promo_interstitial_dismissed"+(t>0?"_"+(t+1):""),{section:"app-interstitial"});var n;t<2?n=e.moment().add(3,"days").toDate():t===2?n=e.moment().add(7,"days").toDate():t===3&&(n=e.moment().add(20,"year").toDate()),this.appContext.setCookie({cookieName:"flaidisn",cookieValue:1,expires:n,remove:!0,path:"/"})},installApp:function(){var r=this.appContext.getUA().os,i="photos/"+this.nsid+"/"+this.photoId,s="https://appstore.com/flickr",o=this;e.rapidTracker.beacon(this.name,"app_promo_interstitial_download",{section:"app-interstitial"}),this.appContext.setCookie({cookieName:"flaidis",cookieValue:1,expires:e.moment().add(20,"year").toDate(),remove:!0,path:"/"}),setTimeout(function(){if(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)){var u=0;u<1?(e.config.win.location=t+i,e.rapidTracker.beacon(o.name,"app_promo_banner_open",{sec:"appbanner",appinstl:"1",appstore:"apple_webview"}),u++):(e.rapidTracker.beacon(o.name,"app_promo_banner_open",{sec:"appbanner",appinstl:"0",appstore:"apple_webview"}),e.config.win.location=s)}else if(r==="android")e.rapidTracker.beacon(o.name,"app_promo_banner_open",{sec:"appbanner",appinstl:"0",appstore:"google"}),e.config.win.location=n+i;else if(r==="ios"){var a=new Date;setTimeout(function(){var t=new Date;t-a<2e3?(e.rapidTracker.beacon(o.name,"app_promo_banner_open",{sec:"appbanner",appinstl:"0",appstore:"apple"}),setTimeout(function(){e.config.win.location=s},200)):e.rapidTracker.beacon(o.name,"app_promo_banner_open",{sec:"appbanner",appinstl:"1",appstore:"apple"})},100),e.config.win.location=t+i}},250)}},{ATTRS:{}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-mobile-app-upsell","mobile-app-upsell-css"],langBundles:["common","mobile"]});
YUI.add("hermes-lang-mobile",function(e,t){e.Intl.add("hermes/mobile","en-US",{APP_IOS:["Flickr for iOS"],APP_ANDROID:["Flickr for Android"],APP_IOS_FREE:["Free in the App Store"],APP_ANDROID_FREE:["Free in the Google Play"],GET:["Get"],INSTALL:["Install"]})},"@VERSION@",{requires:["intl"]});
YUI.add("mobile-photo-page-view",function(e){var t="show-upsell-banner";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,additionalViewClasses:function(){var n=[],r=this.appContext.getUA().os;return(r==="ios"||r==="android")&&n.push(r),!this.appContext.getCookie("dism")&&!this.appContext.getCookie("inst")&&(n.push(t),YUI.Env.isServer||e.rapidTracker.beacon(this.name,"app_promo_interstitial_shown",{section:"app-interstitial"})),n},initializer:function(e){return e.hideMobileBanner=!0,this.photoId=e.photoId,this.nsid=e.nsid,this.deferredViews={"photo-charm-exif-scrappy-view":{photoId:this.photoId,nsid:this.nsid,isMobileExif:!0},"sub-photo-tags-tag-view":{photoId:this.photoId,nsid:this.nsid,isMobileTags:!0}},this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"mobile-app-upsell-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"mobile-attribution-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["clear-float","mobile-photopage-attribution"]},"sub-photo-title-desc-view":{requiredToShowOnClient:!0,isMobile:!0,requiredToShowOnServer:!0},"mobile-photo-engagement-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"sub-photo-right-stats-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isMobileStats:!0},"mobile-sub-photo-stats-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"sub-photo-comments-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isOnMobile:!0},"mobile-photo-well-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["needsclick"]},"footer-full-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e={"global-nav-view":this.subviews["global-nav-view"].get("container"),"mobile-photo-well-view":this.subviews["mobile-photo-well-view"].get("container"),"mobile-attribution-view":this.subviews["mobile-attribution-view"].get("container"),"sub-photo-title-desc-view":this.subviews["sub-photo-title-desc-view"].get("container"),"mobile-photo-engagement-view":this.subviews["mobile-photo-engagement-view"].get("container"),"sub-photo-comments-view":this.subviews["sub-photo-comments-view"].get("container"),"mobile-sub-photo-stats-view":this.subviews["mobile-sub-photo-stats-view"].get("container"),"footer-full-view":this.subviews["footer-full-view"].get("container"),"mobile-app-upsell-view":this.subviews["mobile-app-upsell-view"].get("container")};return this.setContainerHTML(this.templates("mobile-photo-page")(e)),this},buildHeadContainer:function(){var e=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"});this.set("headContainer",e),YUI.Env.isServer||this.updateHead()},isMobile:function(){var t=!1;return YUI.Env.isServer?t=this.appContext.request.UA.isMobileBrowser:t=e.config.flickr.request.UA.isMobileBrowser,t},activate:function(){return e.config.win.document.body.scrollTop>0?this.loadDeferred():(this.scrollListener=e.globalEvents.subscribe("window:scroll",this.loadDeferred.bind(this)),this.registerEventHandler(this.scrollListener)),e.FastClick&&e.FastClick.attach(document.body),this},loadDeferred:function(){if(!this.loadingDeferred){this.loadingDeferred=!0;var e=Object.keys(this.deferredViews).length;this.removeScrollListener(),e>0&&this.recursivelyloadDeferredView(0)}},removeScrollListener:function(){this.scrollListener&&(this.scrollListener.detach(),this.scrollListener=null)},recursivelyloadDeferredView:function(t,n){var r=Object.keys(this.deferredViews).length,i=this;if(t<=r-1){var s=Object.keys(this.deferredViews)[t],o=this.deferredViews[s];this.getDeferredView(s,o).then(function(r){if(!r){e.Flog.error(i.name,"An error occured trying to load the deferred view."),n?(t++,n=!1):n=!0,i.recursivelyloadDeferredView(t,n);return}r.initialize().then(function(){r.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&i.onSubviewEvent.call(i,r.name,e.details)}),i.addDeferredViewToDOM(r),r.normalizedActivate(),t++,i.recursivelyloadDeferredView(t)}).catch(function(r){e.Flog.error(i.name,"An error occured trying to initialize the deferred view:",r),n?(t++,n=!1):n=!0,i.recursivelyloadDeferredView(t,n)})})}},getDeferredView:function(e,t){return this.appContext.getView(e,t)},addDeferredViewToDOM:function(e){var t=this.get("container").one(".deferred-views");t&&t.append(e.get("container"))},onSubviewEvent:function(e,n){n&&(n[0]==="dismissBanner"?this.get("container").removeClass(t):n[0]==="noTags"&&this.get("container").addClass("no-tags"))},getTrackingSegments:function(){return{vwrOwner:this.isOwner?1:0}}},{ATTRS:{spaceid:{value:954010555}}}),e.Base.plug(e.Views[this.name],e.Plugin.FlickrView.TTFPRecorderPlugin,{selector:".main-image"})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","hermes-template-head-meta","hermes-template-mobile-photo-page","attribution-view","footer-full-view","mobile-photo-well-view","sub-photo-right-stats-view","mobile-photo-engagement-view","flickr-view","flog","global-nav-view","mobile-app-upsell-view","url","browser-support","mobile-photo-page-css","mobile-photo-page-deferred-views","photo-charm-exif-scrappy-view-css","ttfp-recorder-plugin"],langBundles:[],optionalRequires:["fastclick"]});
YUI.add("fastclick",function(e,t){(function(){"use strict";function e(t,r){function s(e,t){return function(){return e.apply(t,arguments)}}var i;r=r||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=r.touchBoundary||10,this.layer=t,this.tapDelay=r.tapDelay||200,this.tapTimeout=r.tapTimeout||700;if(e.notNeeded(t))return;var o=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],u=this;for(var a=0,f=o.length;a<f;a++)u[o[a]]=s(u[o[a]],u);n&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,n,r){var i=Node.prototype.removeEventListener;e==="click"?i.call(t,e,n.hijacked||n,r):i.call(t,e,n,r)},t.addEventListener=function(e,n,r){var i=Node.prototype.addEventListener;e==="click"?i.call(t,e,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),r):i.call(t,e,n,r)}),typeof t.onclick=="function"&&(i=t.onclick,t.addEventListener("click",function(e){i(e)},!1),t.onclick=null)}var t=navigator.userAgent.indexOf("Windows Phone")>=0,n=navigator.userAgent.indexOf("Android")>0&&!t,r=/iP(ad|hone|od)/.test(navigator.userAgent)&&!t,i=r&&/OS 4_\d(_\d)?/.test(navigator.userAgent),s=r&&/OS [6-7]_\d/.test(navigator.userAgent),o=navigator.userAgent.indexOf("BB10")>0;e.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(r&&e.type==="file"||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)},e.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!n;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},e.prototype.sendClick=function(e,t){var n,r;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),r=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},e.prototype.determineEventType=function(e){return n&&e.tagName.toLowerCase()==="select"?"mousedown":"click"},e.prototype.focus=function(e){var t;r&&e.setSelectionRange&&e.type.indexOf("date")!==0&&e.type!=="time"&&e.type!=="month"?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},e.prototype.updateScrollParent=function(e){var t,n;t=e.fastClickScrollParent;if(!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},e.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},e.prototype.onTouchStart=function(e){var t,n,s;if(e.targetTouches.length>1)return!0;t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0];if(r){s=window.getSelection();if(s.rangeCount&&!s.isCollapsed)return!0;if(!i){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},e.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},e.prototype.onTouchMove=function(e){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))this.trackingClick=!1,this.targetElement=null;return!0},e.prototype.findControl=function(e){return e.control!==undefined?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},e.prototype.onTouchEnd=function(e){var t,o,u,a,f,l=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,o=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,s&&(f=e.changedTouches[0],l=document.elementFromPoint(f.pageX-window.pageXOffset,f.pageY-window.pageYOffset)||l,l.fastClickScrollParent=this.targetElement.fastClickScrollParent),u=l.tagName.toLowerCase();if(u==="label"){t=this.findControl(l);if(t){this.focus(l);if(n)return!1;l=t}}else if(this.needsFocus(l)){if(e.timeStamp-o>100||r&&window.top!==window&&u==="input")return this.targetElement=null,!1;this.focus(l),this.sendClick(l,e);if(!r||u!=="select")this.targetElement=null,e.preventDefault();return!1}if(r&&!i){a=l.fastClickScrollParent;if(a&&a.fastClickLastScrollTop!==a.scrollTop)return!0}return this.needsClick(l)||(e.preventDefault(),this.sendClick(l,e)),!1},e.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},e.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0:!0},e.prototype.onClick=function(e){var t;return this.trackingClick?
(this.targetElement=null,this.trackingClick=!1,!0):e.target.type==="submit"&&e.detail===0?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},e.prototype.destroy=function(){var e=this.layer;n&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},e.notNeeded=function(e){var t,r,i,s;if(typeof window.ontouchstart=="undefined")return!0;r=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(r){if(!n)return!0;t=document.querySelector("meta[name=viewport]");if(t){if(t.content.indexOf("user-scalable=no")!==-1)return!0;if(r>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(o){i=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(i[1]>=10&&i[2]>=3){t=document.querySelector("meta[name=viewport]");if(t){if(t.content.indexOf("user-scalable=no")!==-1)return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}}}if(e.style.msTouchAction==="none"||e.style.touchAction==="manipulation")return!0;s=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(s>=27){t=document.querySelector("meta[name=viewport]");if(t&&(t.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth))return!0}return e.style.touchAction==="none"||e.style.touchAction==="manipulation"?!0:!1},e.attach=function(t,n){return new e(t,n)},typeof define=="function"&&typeof define.amd=="object"&&define.amd?define(function(){return e}):typeof module!="undefined"&&module.exports?(module.exports=e.attach,module.exports.FastClick=e):window.FastClick=e})(),
/*!
 Copyright (c) 2014 The Financial Times Ltd.

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

*/
e.FastClick=window.FastClick},"@VERSION@",{affinity:"client"});
YUI.add("photo-well-scrappy-view",function(e){var t=1,n=5;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.contextData=e.clone(t.context,!0),this.entryURL=t.backToURL,this.entryTypeIntlKey=t.entryTypeIntlKey,this.isAd=!!t.ad,this.hideBackToLink=t.hideBackToLink||!1,this.publisherUrl=t.publisherUrl,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.numberOfPositionsToPreFetch=t.numberOfPositionsToPreFetch,this.numberOfPositionsToRefetchAt=t.numberOfPositionsToRefetchAt,this},additionalViewClasses:["centered-content"],subviewConfig:{"photo-well-media-scrappy-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-notes-scrappy-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("enable-scrappy-notes")}},"photo-engagement-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"context-slider-scrappy-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"photo-sidebar-toggle-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,neverShowOnServer:!0},"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen","photo-attribution"]},"photo-sidebar-actions-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen"],disabled:function(){return this.appContext.experiments.fullscreen.disableRealFullscreenButtons()}},"people-notes-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:!0}},buildContainer:function(){var e=this,t,n="",r,i=0,s,o,u=".navigate-prev",a=".navigate-next",f,l,c,h,p,d;return this.subviews["photo-sidebar-actions-view"]&&this.subviews["photo-sidebar-actions-view"].get("container").addClass("is-hidden"),this.appContext.experiments.fullscreen.getMode()?this.subviews["attribution-view"]&&(YUI.Env.isServer||this.subviews["attribution-view"].get("container").removeClass("is-always-hidden"),this.contextData.modelName!=="photoList-models"&&this.contextData.modelName!=="explore-models"&&this.subviews["attribution-view"].get("container").addClass("is-hidden"),n=this.subviews["attribution-view"].get("container")):this.subviews["attribution-view"]&&(this.subviews["attribution-view"].get("container").addClass("is-always-hidden"),n=this.subviews["attribution-view"].get("container")),this.get("contextModel")&&(r=this.get("contextModel").getValue("photoContextList").getList(),r.length>2&&r.some(function(t){return i++,t.getValue("id")===e.photoId})&&(s=r.slice(i-2,i-1),o=r.slice(i,i+1),s&&s.length>0&&(f=e.setupNavLink(s[0],u,"previous"),s[0].getValue("owner")&&(s[0].getValue("title").trim()===""?c=e.intlMessage({intlName:"common.UNTITLED"}):c=s[0].getValue("title"),c+=" | "+e.intlMessage({intlName:"common.BY_USER",user:s[0].getValue("owner").getValue("username")}))),o&&o.length>0&&(l=e.setupNavLink(o[0],a,"next"),o[0].getValue("owner")&&(o[0].getValue("title").trim()===""?h=e.intlMessage({intlName:"common.UNTITLED"}):h=o[0].getValue("title"),h+=" | "+e.intlMessage({intlName:"common.BY_USER",user:o[0].getValue("owner").getValue("username")}))))),p=this.getPhotoWellHeight(),d=p-70,t=this.templates("photo-well-scrappy")({"photo-well-media-view":this.subviews["photo-well-media-scrappy-view"].get("container"),"photo-notes-scrappy-view":this.subviews["photo-notes-scrappy-view"]?this.subviews["photo-notes-scrappy-view"].get("container"):"","context-slider-view":this.subviews["context-slider-scrappy-view"].get("container"),"is-hidden":!f&&!l,"prev-is-not-clickable":!f,"next-is-not-clickable":!l,"prev-url":f,"next-url":l,"prev-title":c,"next-title":h,"is-ad":this.isAd,"photo-sidebar-toggle-view":this.subviews["photo-sidebar-toggle-view"]?this.subviews["photo-sidebar-toggle-view"].get("container"):"","photo-sidebar-actions-view":this.subviews["photo-sidebar-actions-view"]?this.subviews["photo-sidebar-actions-view"].get("container"):"","attribution-view":n,"people-notes-view":this.subviews["people-notes-view"]?this.subviews["people-notes-view"].get("container"):"",height:p,"photo-engagement-view":this.subviews["photo-engagement-view"].get("container"),navHeight:d,entryURL:this.entryURL,backToLabel:this.intlMessage({intlName:"photo-page-scrappy."+this.entryTypeIntlKey}),enableZoom:this.appContext.flipper.isFlipped("enable-scrappy-zoom"),hideBackToLink:this.hideBackToLink}),this.setContainerHTML(t),YUI.Env.isServer||(this.subviews["photo-well-media-scrappy-view"]&&this.subviews["photo-well-media-scrappy-view"].fire("parentViewEvent","photoWellResized"),this.subviews["photo-notes-scrappy-view"]&&this.subviews["photo-notes-scrappy-view"].fire("parentViewEvent","photoWellResized")),YUI.Env.isServer&&(this.serverWidth=this.subviews["photo-well-media-scrappy-view"].serverWidth,this.serverHeight=this.subviews["photo-well-media-scrappy-view"].serverHeight),this},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){if(!e)throw new Error("[photo-well-view] Invalid photoModel returned from getModel");t.set("photo",e)})),this.contextData&&this.contextData.modelName&&this.contextData.params&&n.push(this.appContext.getModelRegistry(this.contextData.modelName).then(function(n){var r;if(n){r=n.attributeSearch(t.contextData.params);if(r&&r.length&&n.exists(r[0]))return t.appContext.getModel(t.contextData.modelName,r[0]).then(function(e){e&&t.set("contextModel",e)},function(n){return e.Flog.error(t.name,"photo not found in context. Loading photostream instead."),t.loadPhotostreamContext()})}}).then(null,function(){return"whatever"})),e.Promise.all(n)},buildHeadContainer:function(){var e=this.templates("photo-page-right-size-express")({photoWidth:this.get("photo").getLargestSize().width,photoHeight:this.get("photo").getLargestSize().height});return this.set("headContainer",e),this},setLinkAsAdFriendly:function(e){var t=e.currentTarget;t.
hasClass("navigate-next")?this.appContext.adManager.setAdCouldBeShown(!0,"next",t.getAttribute("href")):this.appContext.adManager.setAdCouldBeShown(!0,"previous",t.getAttribute("href"))},animateNavigation:function(){var t=e.all(".navigate-target"),n=this.get("container"),r=n.one(".photo-sidebar-toggle-view"),i=n.one(".attribution-view"),s=1500,o=250,u=!1,a=!1,f,l=!0,c=this;s=(s-500)/2,u=!0,a=this.appContext.experiments.fullscreen.getMode(),this.registerEventHandler(this.get("container").on("mousemove",e.betterThrottle(function(e){f=n.one(".photo-sidebar-actions-view"),t&&l&&t.removeClass("is-hidden"),u&&l&&(f&&f.removeClass("is-hidden"),r&&r.removeClass("is-hidden"),i&&i.removeClass("is-hidden")),clearTimeout(c.movingTimeout),clearTimeout(c.initialTimeout),l=!0,c.movingTimeout=setTimeout(function(){f=n.one(".photo-sidebar-actions-view"),u&&(f&&f.addClass("is-hidden"),i&&i.addClass("is-hidden"))},s*2)},o))),this.contextData.modelName!=="photoList-models"&&this.contextData.modelName!=="explore-models"&&(l=!1),c.initialTimeout=setTimeout(function(){l=!0,f=n.one(".photo-sidebar-actions-view"),u&&l&&(f&&f.addClass("is-hidden"),i&&i.addClass("is-hidden"))},s*2)},activate:function(){var r=this,i=this.contextData,s=0,o,u,a,f,l,c=".navigate-prev",h=".navigate-next",p=this.appContext.getViewer().prefs.keyboardShortcutsEnabled;return YUI.Env.isServer||(u=e.getLocation(),a=u.protocol,f=u.hostname,r.appContext.getModel(i.modelName,i.params).then(function(e){r.set("contextModel",e)},function(t){if(!t.getModelFailure&&t.code!==1||i.modelName==="photostream-models")throw e.one(c).hide(),e.one(h).hide(),t;return r.contextData.modelName="photostream-models",r.contextData.params.id=r.get("photo").getValue("owner").getValue("nsid"),r.appContext.getModel("photostream-models",r.contextData.params).then(function(e){r.set("contextModel",e)})}).then(function(){var t=r.get("contextModel").getValue("photoContextList"),n=t.getList(),o,u,p,d;return n.length>2&&n.some(function(e){return s++,e.getValue("id")===r.photoId})&&(o=n.slice(s-2,s-1),u=n.slice(s,s+1),o&&o.length>0&&(p=r.setupNavLink(o[0],c,"previous"),p&&(r.updateNavLinks(r.get("container").one(c),a,f,p),r.get("container").one(c).removeClass("no-click"))),u&&u.length>0&&(d=r.setupNavLink(u[0],h,"next"),d&&(r.updateNavLinks(r.get("container").one(h),a,f,d),r.get("container").one(h).removeClass("no-click")))),l=e.merge(i.params,{photoId:r.photoId,numNext:r.numberOfPositionsToPreFetch,numPrev:r.numberOfPositionsToPreFetch,refetchAt:r.numberOfPositionsToRefetchAt}),t.getContext(l)}).then(function(i){function s(s,o){var u=r.get("container").one(s),l,c,h,p,d,v,m=i&&i[o]&&i[o].length,g;if(!u)return;if(!m){u.remove();return}u.removeClass("no-click"),l=r.setupNavLink(i[o][0],s,o);if(r.isAd)h=r.appContext.adManager.origin,o===h.arrow?(u.setAttribute("href",h.url),u.removeClass("is-hidden")):(u.setAttribute("href",l),u.removeClass("is-hidden"));else{r.updateNavLinks(u,a,f,l),c=r.subviews["photo-well-media-scrappy-view"].getCanvasSize();for(v=0;v<n;v++){if(!i[o][v])break;p=i[o][v].getSizeToFit(c,{includeSizes:["sq","q","t","s","n"]}),p&&p.url&&(d=new Image,d.src=p.url)}for(v=0;v<t;v++){if(!i[o][v])break;p=i[o][v].getSizeToFit(c),p&&p.url&&(d=new Image,g=e.guid(),window.LH&&window.LH.mark("mark_time_to_load_photo_only_start"+g),d.onload=function(){if(d.onloadFired)return;d.onloadFired=!0;try{window.LH.mark("mark_time_to_load_photo_only"+g),window.LH.measure("time_to_load_photo_only",{startMark:"mark_time_to_load_photo_only_start"+g,endMark:"mark_time_to_load_photo_only"+g})}catch(t){e.Flog.warn("time to load photo: Missing start mark")}},d.src=p.url,d.complete&&(d.onloadFired=!0))}}}r.appContext.adManager.updateContext({prev:i.previous[0],current:r.get("photo"),next:i.next[0],type:r.contextData.modelName,entryURL:r.entryURL}),s(h,"next"),s(c,"previous"),r.animateNavigation(),r.isAd&&r.appContext.adManager.markAdAsSeen()},function(e){if(e.notInContext||e.code===99)return r.get("contextModel").setValue("photoContextList",[]),r.contextData.modelName="photostream-models",r.contextData.params.id=r.get("photo").getValue("owner").getValue("nsid"),r.activate();throw e}).then(null,function(e){r.appContext.warn("There was a problem initializing the next/previous controls.",e&&e.message?e.message:e,e&&e.stack?e.stack:"")}),p&&this.attachKeyEvent("down:37,75,39,74",r.handlePrevNextKeys.bind(r)),this.get("photo").getValue("isOwner")||this.appContext.getViewCounter().queue(this.get("photo").getValue("id"),this.publisherUrl||this.appContext.getReferrer())),o={":ad":r.setLinkAsAdFriendly},p&&!this.hideBackToLink&&this.attachKeyEvent("down:66",function(t){t.preventDefault(),e.rapidTracker.beacon(r.name,"backToContextKeyPress"),r.appContext.flapp.hasRoute(r.entryURL)?r.appContext.flapp.navigate(r.entryURL):e.config.win.location.href=r.entryURL}),r.registerEventHandler(e.on("resize",e.betterThrottle(function(e){r.set("canvasSizeIsDirty",!0),r.buildContainer()},16))),r.buildContainer(),r.attachEvents(o),this},getPhotoWellHeight:function(){var e=500,t=this.appContext.viewportData.getWidth(),n=this.appContext.viewportData.getHeight()-50,r=1,i=2.3,s=2.75,o=120,u=t/r+o,a=t/i+o,f=t/s,l;return n>u?l=t/r:n>a?l=n-o:n>f?l=n-o+o*(n-a)/(f-a):l=n,Math.max(e,Math.round(l))},setupNavLink:function(t,n,r){var i=this.get("container").one(n),s,o;if(!t){i.remove();return}s=t,o=e.URLHelper.getPhotoPage({photoId:s.getValue("id"),pathAlias:s.getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextModel").getValue("urlSuffix")});if(!o||o==="#"){this.appContext.warn("[photo-well-view] Invalid next/prev URL:",o),i.remove();return}return o},updateNavLinks:function(e,t,n,r){e.setAttribute("href",t+"//"+n+r),e.removeClass("is-hidden")},destructor:function(){clearTimeout(this.movingTimeout),clearTimeout(this.initialTimeout),this.movingTimeout=null,this.initialTimeout=null},handlePrevNextKeys:function(t){var n=this,r,i,s,o=50;if(t.button===37||t.button===75)i=".navigate-prev",s="previous",e.rapidTracker.beacon
(this.name,"prevPhotoKeyPress");else if(t.button===39||t.button===74)i=".navigate-next",s="next",e.rapidTracker.beacon(this.name,"nextPhotoKeyPress");i&&n.get("container").one(i)&&(t.preventDefault(),r=n.get("container").one(i).getAttribute("href"),r&&r!=="#"&&(n.keyboardNavigation&&n.keyboardNavigation.url&&r===n.keyboardNavigation.url&&(new Date).getTime()-n.keyboardNavigation.time<o?n.appContext.debug("[photo-well-view] Ignoring duplicate keyboard navigation within "+o+"ms",r):(n.keyboardNavigation={url:r,time:(new Date).getTime()},this.appContext.adManager.setAdCouldBeShown(!0,s,r),n.appContext.flapp.navigate(r))))},handleContextMenu:function(e){e.preventDefault(),this.fire("parentViewEvent","rightClickPhoto")}})},"@VERSION@",{requires:["yui-throttle","flickr-view","hermes-template-photo-well-scrappy","photo-well-scrappy-css","url-helper","better-throttle","hermes-template-photo-page-right-size-express"],optional:["photo-well-media-scrappy-view","context-slider-scrappy-view","photo-engagement-view","photo-models","photo-route"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-sub-photo",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="sub-photo-container centered-content">\n    ',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["sub-photo-left-view"],u):a.call(t,"outlet",t["sub-photo-left-view"],u)))+"\n    ",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["sub-photo-right-view"],u):a.call(t,"outlet",t["sub-photo-right-view"],u)))+'\n    <div style="clear: both;"></div>\n    ',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["sub-photo-keyboard-shortcuts-view"],u):a.call(t,"outlet",t["sub-photo-keyboard-shortcuts-view"],u)))+"\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-sub-photo-left",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["attribution-view"],u):a.call(t,"outlet",t["attribution-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["sub-photo-title-desc-view"],u):a.call(t,"outlet",t["sub-photo-title-desc-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["sub-photo-fave-view"],u):a.call(t,"outlet",t["sub-photo-fave-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["sub-photo-comments-view"],u):a.call(t,"outlet",t["sub-photo-comments-view"],u))),s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo-left",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-sub-photo-title-desc",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i,s,u;r+="\n\n	",i=n["if"].call(e,e.isMobile,{hash:{},inverse:o.noop,fn:o.program(2,c,t),data:t});if(i||i===0)r+=i;r+='\n\n	<div class="title-desc-block ',i=n["if"].call(e,e.isOwner,{hash:{},inverse:o.noop,fn:o.program(5,p,t),data:t});if(i||i===0)r+=i;r+=" ",i=n.unless.call(e,e.enableCollapsableTitleAndDescription,{hash:{},inverse:o.noop,fn:o.program(7,d,t),data:t});if(i||i===0)r+=i;r+='">\n		',i=n.unless.call(e,e.noTitleToDisplay,{hash:{},inverse:o.noop,fn:o.program(9,v,t),data:t});if(i||i===0)r+=i;r+="\n\n		",i=n.unless.call(e,e.noDescToDisplay,{hash:{},inverse:o.noop,fn:o.program(17,w,t),data:t});if(i||i===0)r+=i;r+='\n\n		<button class="ui-button ui-button-cta done-editing-title-desc" data-action="saveTitleDescEdit">',u={hash:{intlName:"common.DONE"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,u):f.call(e,"intlMessage",u)))+"</button>\n\n	</div>\n\n	",s=n["if"].call(e,e.enableCollapsableTitleAndDescription,{hash:{},inverse:o.noop,fn:o.program(20,S,t),data:t});if(s||s===0)r+=s;return r+="\n\n",r}function c(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.isOwner,{hash:{},inverse:o.noop,fn:o.program(3,h,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function h(e,t){return'\n			<svg class="title-desc-edit mobile-edit-title-desc icon icon-edit"><use xlink:href="#icon-edit"></use></svg>\n		'}function p(e,t){return"editable"}function d(e,t){return"showFull"}function v(e,t){var r="",i,s;r+='\n			<h1 class="',i=n["if"].call(e,e.isOwner,{hash:{},inverse:o.noop,fn:o.program(5,p,t),data:t});if(i||i===0)r+=i;r+=" meta-field photo-title ",s=n["if"].call(e,(i=e.empty,i==null||i===!1?i:i.title),{hash:{},inverse:o.noop,fn:o.program(10,m,t),data:t});if(s||s===0)r+=s;r+='">\n				',s=n["if"].call(e,e.title,{hash:{},inverse:o.noop,fn:o.program(12,g,t),data:t});if(s||s===0)r+=s;r+="\n			</h1>\n\n			",s=n.unless.call(e,e.isMobile,{hash:{},inverse:o.noop,fn:o.program(14,y,t),data:t});if(s||s===0)r+=s;return r+='\n\n			<input type="text" class="meta-field edit-meta-field edit-photo-title" wrap="on"></input>\n			<input type="text" class="meta-field edit-meta-field false-textarea false-edit-photo-title" wrap="on" tabindex="-1"></input>\n\n		',r}function m(e,t){return"placeholder-text"}function g(e,t){var r="",i;return r+="\n					",(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n				",r}function y(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.isOwner,{hash:{},inverse:o.noop,fn:o.program(15,b,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function b(e,t){var r="",i,s;return r+='<a href="#" class="title-desc-edit ui-icon-title-desc-edit" data-action="edit" title="',s={hash:{intlName:"common.EDIT"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'"></a>',r}function w(e,t){var r="",i,s;r+='\n			<h2 class="',i=n["if"].call(e,e.isOwner,{hash:{},inverse:o.noop,fn:o.program(5,p,t),data:t});if(i||i===0)r+=i;r+=" meta-field photo-desc ",s=n["if"].call(e,(i=e.empty,i==null||i===!1?i:i.desc),{hash:{},inverse:o.noop,fn:o.program(10,m,t),data:t});if(s||s===0)r+=s;r+='">\n				',s=n["if"].call(e,e.description,{hash:{},inverse:o.noop,fn:o.program(18,E,t),data:t});if(s||s===0)r+=s;return r+='\n			</h2>\n\n			<textarea class="meta-field edit-meta-field edit-photo-desc" wrap="on"></textarea>\n			<textarea class="meta-field edit-meta-field false-textarea false-edit-photo-desc" wrap="on" tabindex="-1"></textarea>\n		',r}function E(e,t){var r="",i,s;return r+="\n					",s={hash:{},data:t},r+=a((i=n.photoDescription||e.photoDescription,i?i.call(e,e.description,s):f.call(e,"photoDescription",e.description,s)))+"\n				",r}function S(e,t){var r="",i,s;r+="\n		",s=n.unless.call(e,(i=e.empty,i==null||i===!1?i:i.desc),{hash:{},inverse:o.noop,fn:o.program(21,x,t),data:t});if(s||s===0)r+=s;return r+="\n	",r}function x(e,t){var r="",i,s;return r+='">\n			<span class="title-desc-more-button">',s={hash:{intlName:"common.MORE"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</span>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=this,u="function",a=this.escapeExpression,f=n.helperMissing;return s=n.unless.call(t,t.noContentToDisplay,{hash:{},inverse:o.noop,fn:o.program(1,l,i),data:i}),s||s===0?s:""}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo-title-desc",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-editing-shim",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'<div class="editing-shim">&nbsp;</div>'}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/editing-shim",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("flickr-photos-addTags-creator",function(e,t){"use strict";function n(e){e.tags=e.tags||[];var t={};return t.photo_ids=e.photoId.join(","),t.tags=e.tags.join(","),e.fullResponse&&(t.full_response=1),t.extras="is_autotag",t}function r(e,t){var n=e[0],r,i=e[1],s=e[2],o=[],u,a;r=n.errors;if(!t.fullResponse){n.tags.tag.forEach(function(e){s.exists(e.id)||s.add({id:e.id,tagRaw:e.raw,tagValue:e.content.replace(/\s/g,""),tagAuthorNSID:e.author,duplicateAutotagId:e.duplicateAutotag}),o.push(s.proxy(e.id))});for(u=0;u<t.photoId.length;u++)a=t.photoId[u],i.exists(a)?o.forEach(function(e){i.getValue(a,"tags").appendToList(e)}):i.add({id:a,tags:o});return o}if(r&&r.length>0)return r}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photos.addTags",this._processParams(n)),r.getModelRegistry("photo-tags-models"),r.getModelRegistry("tag-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw n.fullResponse&&(e.photoIds=n.photoId),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photos-addTags"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-tags-models","tag-models"]});
YUI.add("flickr-photos-removeTag-deletor",function(e,t){"use strict";function n(n,r){var i={};return typeof n=="string"?i.tag_id=n:typeof n=="object"&&(i.global_tag_ids=n.globalTagIds.join(","),i.photo_ids=n.photoIds.join(",")),r.callAPI("flickr.photos.removeTag",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-photos-removeTag"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("tag-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{create:function(t){return e.ModelCreators["flickr-photos-addTags"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-removeTag"].run(t,this.appContext)}},attributes:{tagValue:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t.trim().replace(/\s/g,""))}},tagRaw:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},tagAuthorNSID:{},isMachineTag:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},url:{derivedBy:["tagValue"],readOnly:!0,defaultFn:function(e){var t=this.getValue(e,"tagValue");return t?"/photos/tags/"+t:undefined}},searchUrl:{derivedBy:["tagValue","tagRaw","isMachineTag"],readOnly:!0,defaultFn:function(e){var t=this.getValue(e,"tagRaw"),n=this.getValue(e,"tagValue"),r=this.getValue(e,"isMachineTag"),i;return t&&r?(t.indexOf(" ")>0&&(i=t.indexOf("=")+1,t=t.substring(0,i)+'"'+t.substring(i)+'"'),"/search/?tags="+t):n?"/search/?tags="+n:undefined}},duplicateAutotagId:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});
YUI.add("flickr-tags-getListPhoto-fetcher",function(e,t){"use strict";function n(t,n,r){var i=t[0],s=t[1],o=t[2],u=i.photo&&i.photo.tags&&typeof i.photo.tags.tag!="undefined"?i.photo.tags.tag.length:0,a=[],f=t[3],l=t[4],c=0,h=[],p;return u>0&&e.Array.each(i.photo.tags.tag,function(e){typeof e.content=="string"&&(o.exists(e.id)||o.add({id:e.id,tagRaw:e.raw,tagValue:e.content,tagAuthorNSID:e.author,isMachineTag:e.machineTag,duplicateAutotagId:e.duplicateAutotag}),a.push(o.proxy(e.id)))}),s.exists(n)?s.setValue(n,"tags",a):s.add({id:n,tags:a}),p={id:n},i.photo&&i.photo.autotags&&typeof i.photo.autotags.autotag!="undefined"&&(c=i.photo.autotags.autotag.length),c>0&&e.Array.each(i.photo.autotags.autotag,function(e){typeof e.content=="string"&&(l.exists(e.id)||l.add({id:e.id,autotagValue:e.content,score:e.confidence,isPrivate:e.private}),h.push(l.proxy(e.id)))}),p.autotags={page:1,perPage:1e3,pageContent:h,totalItems:c},f.exists(n)?f.setValue(n,"autotags",p.autotags):f.add(p),s.proxy(n)}function r(n,r){var i=n.id,s={photo_id:i,extras:"autotags",lang:r.lang},o=this;return e.Promise.all([r.callAPI("flickr.tags.getListPhoto",s),r.getModelRegistry("photo-tags-models"),r.getModelRegistry("tag-models"),r.getModelRegistry("photo-autotags-models"),r.getModelRegistry("autotag-models")]).then(function(e){return o._processResponse(e,i,r.flipper)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-tags-getListPhoto"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["tag-models","photo-tags-models"]});
YUI.add("photo-tags-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-tags-getListPhoto"].run(t,this.appContext)},create:function(t){return e.ModelCreators["flickr-photos-addTags"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-removeTag"].run(t,this.appContext)}},attributes:{tags:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-tags-getListPhoto-fetcher","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});
